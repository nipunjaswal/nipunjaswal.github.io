<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="Nipun Jaswal">
<meta name="description"
    content="Long time huh? I just updated my website and i am hoping that you will like the new look and feel. I have been working recently on tons of AV solutions, trying to get the insight of how can one evade detection without using any crypters or obfuscation. Ahh, i know the topic is a bit touchy or you may think why am i discussing AV bypasses at the first place." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/2017/08/antivirus-evasion-for-dummies/" />


<title>
    
    Antivirus Evasion for dummies :: VAPT.IO - Home of the Next Gen Cyber Ninja  — Learn Vulnerability Assessment and Penetration Testing
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.7bfbbe12786fa0ded4b4c0d792cbb36a5bd0bdb0b856dde57aa7b1f6fe0f2b87.css">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="Antivirus Evasion for dummies">
<meta itemprop="description" content="Long time huh? I just updated my website and i am hoping that you will like the new look and feel. I have been working recently on tons of AV solutions, trying to get the insight of how can one evade detection without using any crypters or obfuscation. Ahh, i know the topic is a bit touchy or you may think why am i discussing AV bypasses at the first place.">


<meta itemprop="datePublished" content="2017-08-14T00:08:00&#43;05:30" />
<meta itemprop="dateModified" content="2017-08-14T00:08:00&#43;05:30" />
<meta itemprop="wordCount" content="380">



<meta itemprop="keywords" content="clamav,dll hijacking,antivirus evasion,bypassing antivirus," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="Antivirus Evasion for dummies"/>
<meta name="twitter:description" content="Long time huh? I just updated my website and i am hoping that you will like the new look and feel. I have been working recently on tons of AV solutions, trying to get the insight of how can one evade detection without using any crypters or obfuscation. Ahh, i know the topic is a bit touchy or you may think why am i discussing AV bypasses at the first place."/>




<meta property="article:published_time" content="2017-08-14 00:08:00.003 &#43;0530 IST" />







    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">ap3x@vapt.io:~#</span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>2 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title"><a href="/posts/2017/08/antivirus-evasion-for-dummies/">Antivirus Evasion for dummies</a></h1>

            

            <div class="post-content">
                <p>Long time huh? I just updated my website and i am hoping that you will
like the new look and feel. I have been working recently on tons of AV
solutions, trying to get the insight of how can one evade detection
without using any crypters or obfuscation. Ahh, i know the topic is a
bit touchy or you may think why am i discussing AV bypasses at the first
place. Frankly, while conducting a penetration test ( the formal name
given to breaking into systems) we may come across plenty of protection
mechanisms such as AVs / Firewalls and much more. Keeping in mind this
equation i thought of sharing the most basic AV evasion techniques( Just
to understand how AV thing work). For this specific topic, we will use
ClamAV (Open Source and fun to play with)
<p align="center">
<a href="/images/2017-08-14-antivirus-evasion-for-dummies-clamav.png"><img src="/images/2017-08-14-antivirus-evasion-for-dummies-clamav.png" alt="" /></a>
</p>
However, the methods apply to all AV solutions(All you need to decode
are the signatures using good unpackers).
<strong>The Setup:</strong>
We will be using the latest ubuntu while having ClamAV installed over
it.</p>

<p><strong>The Sample:</strong>
For the demo, i will be using a random CVE 2010-3333 sample which is
detected on almost every odd AV solution.</p>

<p><strong>The Idea:</strong>
Since the idea is not to obfuscate the file but to reverse the
signatures and find what is being detected. We will keep it simple and
make use of sigtool (comes along with ClamAV) to unpack the signatures.
Having the decoded signatures, we can simply run a scan over the
infected file which will let us know the exact signature causing the
detection, in some cases, the signature will only be the hash of the
infected file which can easily be bypassed by just appending a space to
the document. In other cases, it may detect a pattern in the file. In
such cases, we will see how we can find what the antivirus is looking
for and correct it in our malicious payload. let&rsquo;s jump into the demo as
follows:
<p align="center">
<a href="http://www.youtube.com/watch?feature=player_embedded&v=fjka-uaN4kM
" target="_blank"><img src="http://img.youtube.com/vi/fjka-uaN4kM/0.jpg"
alt="phreaking" border="2" /></a>
</p></p>

<p>As shown in the demo, we can easily bypass signature based detections
and patterns looked for by the AV solutions.</p>

<p><strong>Note: This tutorial is for educational purposes only, the idea of such
tutorials is to educate newbies and security enthusiasts to build
effective signatures and get a little know-how about Antivirus
solutions.</strong></p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="/tags/clamav">clamav</a></span><span class="tag"><a href="/tags/dll-hijacking">dll hijacking</a></span><span class="tag"><a href="/tags/antivirus-evasion">antivirus evasion</a></span><span class="tag"><a href="/tags/bypassing-antivirus">bypassing antivirus</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>380 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2017-08-14 00:08 &#43;0530</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h"></span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="/posts/2017/11/postpone-your-marriage-plans-and-deal-with-the-hack-first/">
                                <span class="button__icon">←</span>
                                <span class="button__text">Postpone your Marriage plans and Deal with the Hack first</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="/posts/2016/09/recreating-a-usb-rubber-ducky-under-4-in-india/">
                                <span class="button__text">Recreating a USB Rubber Ducky under $4 in India</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2019</span>
            
                <span><a href="/">Apex Predator</a></span>
            
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span> <a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.4c3fb12a087ceed4a52cb5d57068a9795c7069617a01ca70f788052ad66e1791779e6c72686e1dc0ca13dc03b0203204b6566bb0dd1ee80de2b7ff4d8fe53db2.js" integrity="sha512-TD&#43;xKgh87tSlLLXVcGipeVxwaWF6Acpw94gFKtZuF5F3nmxyaG4dwMoT3AOwIDIEtlZrsN0e6A3it/9Nj&#43;U9sg=="></script>



    </body>
</html>
