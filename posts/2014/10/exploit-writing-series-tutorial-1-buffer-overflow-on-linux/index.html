<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="Nipun Jaswal">
<meta name="description"
    content="Hey folks, i have been thinking for so long to start a noob friendly series on exploit writing but never got that much time. Anyways, let&amp;rsquo;s talk about exploit writing-  So, What is an exploit? an exploit is a piece of code that takes the advantage of a vulnerable system.
However, keeping this a noob friendly tutorial let&amp;rsquo;s make some things very clear. Firstly, an exploit may or may not work on two different application versions, may not work on two different operating systems." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/2014/10/exploit-writing-series-tutorial-1-buffer-overflow-on-linux/" />


<title>
    
    Exploit Writing Series Tutorial 1: Buffer Overflow on Linux :: VAPT.IO - Home of the Next Gen Cyber Ninja  — Learn Vulnerability Assessment and Penetration Testing
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.7bfbbe12786fa0ded4b4c0d792cbb36a5bd0bdb0b856dde57aa7b1f6fe0f2b87.css">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="Exploit Writing Series Tutorial 1: Buffer Overflow on Linux">
<meta itemprop="description" content="Hey folks, i have been thinking for so long to start a noob friendly series on exploit writing but never got that much time. Anyways, let&rsquo;s talk about exploit writing-  So, What is an exploit? an exploit is a piece of code that takes the advantage of a vulnerable system.
However, keeping this a noob friendly tutorial let&rsquo;s make some things very clear. Firstly, an exploit may or may not work on two different application versions, may not work on two different operating systems.">


<meta itemprop="datePublished" content="2014-10-27T21:05:00&#43;05:30" />
<meta itemprop="dateModified" content="2014-10-27T21:05:00&#43;05:30" />
<meta itemprop="wordCount" content="957">



<meta itemprop="keywords" content="learn exploit development,linux exploit writing,exploit writing part 1,exploit writing," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="/"/>

<meta name="twitter:title" content="Exploit Writing Series Tutorial 1: Buffer Overflow on Linux"/>
<meta name="twitter:description" content="Hey folks, i have been thinking for so long to start a noob friendly series on exploit writing but never got that much time. Anyways, let&rsquo;s talk about exploit writing-  So, What is an exploit? an exploit is a piece of code that takes the advantage of a vulnerable system.
However, keeping this a noob friendly tutorial let&rsquo;s make some things very clear. Firstly, an exploit may or may not work on two different application versions, may not work on two different operating systems."/>




<meta property="article:published_time" content="2014-10-27 21:05:00.003 &#43;0530 IST" />







    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">ap3x@vapt.io:~#</span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="/about/">About</a></li><li><a href="/posts/">Posts</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>5 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title"><a href="/posts/2014/10/exploit-writing-series-tutorial-1-buffer-overflow-on-linux/">Exploit Writing Series Tutorial 1: Buffer Overflow on Linux</a></h1>

            

            <div class="post-content">
                

<p>Hey folks,
i have been thinking for so long to start a noob friendly series on
exploit writing but never got that much time. Anyways, let&rsquo;s talk about
exploit writing-
<p align="center">
<a href="/images/2014-10-27-exploit-writing-series-tutorial-1-buffer-overflow-on-linux-overflow.jpg"><img src="/images/thumbnails/2014-10-27-exploit-writing-series-tutorial-1-buffer-overflow-on-linux-overflow.jpg" alt="" /></a>
</p></p>

<h2 id="so-what-is-an-exploit">So, What is an exploit?</h2>

<p>an exploit is a piece of code that takes the advantage of a vulnerable
system.</p>

<p>However, keeping this a noob friendly tutorial let&rsquo;s make some things
very clear. Firstly, an exploit may or may not work on two different
application versions, may not work on two different operating systems.
Secondly, if you think you already know basics, you can leave the
website immediately.</p>

<p>Well, Throughout this series we will start from the very basic (I Mean
it :P) this means we will take up things as soon as they appear. So, you
don&rsquo;t have to worry about ASM, Comp. Architecture etc.</p>

<h3 id="pre-requisites">Pre-Requisites</h3>

<p>I already mentioned that we will take up things as soon as they appear.
However, for this tutorial you should have a lil knowledge about C
Programming.</p>

<p>So, let&rsquo;s take up the most basic &ldquo;Stack based Buffer Overflows&rdquo; at the
very first stage-</p>

<h2 id="now-what-is-a-stack">Now, what is a stack?</h2>

<p><p align="center">
<a href="/images/2014-10-27-exploit-writing-series-tutorial-1-buffer-overflow-on-linux-books-20clip-20art-jixpyXdiE.png"><img src="/images/thumbnails/2014-10-27-exploit-writing-series-tutorial-1-buffer-overflow-on-linux-books-20clip-20art-jixpyXdiE.png" alt="" /></a>
</p>
We can see in the above picture that we organized every book one above
the other. However, we can collectively say that this is a stack of
books. Now, to build this stack, we placed the first book, then the
other on top of it and so on until we run out of books.</p>

<p>Exactly, what follows in Computer systems. We can put operands and
operators one above the other to form a stack. This is called the
&ldquo;<strong>Push</strong>&rdquo; operation. This also means that the first book is now at the
bottom and the last one is at the top. This is why stack is called
<strong>Last-in-First-Out</strong>. So, when we need to remove a book, we first need
to remove the book at the top, this is called the &ldquo;<strong>Pop</strong>&rdquo; operation.</p>

<h2 id="so-what-is-buffer-overflow">So, What is Buffer Overflow?</h2>

<p>A buffer is a region which stores data temporarily and when more data
than its capacity is supplied, it gets overflowed.</p>

<p><strong>Let&rsquo;s see an example-</strong></p>

<pre><code>#include&lt;stdio.h&gt;
#include&lt;string.h&gt;
&lt;include&lt;stdlib.h&gt;

 void noexec()
 {
 printf(&quot;this never executes&quot;);
 exit(0);
 }

 void main(int argc, char **argv)
 {
 char buffer[50];
 strcpy(buffer,argv[1]);
 printf(buffer);
 }
</code></pre>

<p>In the above program, we have two different functions <code>main</code> and
<code>noexec</code>. When we run this program, it simply receives the command
line argument, copies it into the <code>buffer</code> variable and simply prints
it.</p>

<p>Now, you might ask, why do we have <code>noexec()</code> function if we are
not calling it any where in the program? this is because in order to
work out the simplest buffer overflow, we will try to execute this
function by exploiting it.</p>

<p>Let&rsquo;s compile this program using the following command:</p>

<pre><code>#gcc -ggdb -o rofl -fno-stack-protector expl1.c -mpreferred-stack-boundary=2
</code></pre>

<p>To compile a C program in linux, we use <code>gcc</code>, <code>-ggdb</code> option allows the
code to be executed and listed in debugger by supplying enough
information to the debugger, about the program, <code>-fno-stack-protector</code> option turns off stack protection mechanisms in Linux while compiling the program and <code>-mpreferred-stack-boundary=2</code> option aligns the stack
on a 4-byte boundary and will be susceptible to crash as well. However,
by default it&rsquo;s on 16-byte boundary.</p>

<p><strong>(You can Skip the above paragraph, for now we just need to focus on
compiling the application program)</strong></p>

<p><p align="center">
<a href="/images/2014-10-27-exploit-writing-series-tutorial-1-buffer-overflow-on-linux-1.png"><img src="/images/thumbnails/2014-10-27-exploit-writing-series-tutorial-1-buffer-overflow-on-linux-1.png" alt="" /></a>
</p>
Let&rsquo;s execute the program, and supply <code>50</code> A&rsquo;s, we can see that it gets
printed, Let&rsquo;s try with <code>51</code> A&rsquo;s, <code>52</code> A&rsquo;s and <code>53</code> A&rsquo;s. We can see that
program exited normally after outputting the supplied input. However, as
soon as we provide <code>54</code> A&rsquo;s we get <code>Segmentation Fault</code> which denotes
crashing of the program or we can say the buffer just overflowed. You
might ask, we had the buffer for 50 characters but it still got executed
at 51,52,53. This is because the input didn&rsquo;t overwrote the values fetched to the EIP register
initially and may have overwrote other registers which didn&rsquo;t affected
the program&rsquo;s execution.</p>

<h2 id="what-is-eip">What is EIP?</h2>

<p>A register which stores the address of the next instruction. Therefore,
if we overwrite the return pointer which EIP register loads, we can have the address of our choice, our
choice will be the next instruction to be executed by the program. This
potentially means that we can redirect the flow of a program to anywhere
we want.</p>

<p>Let&rsquo;s open this program in GDB:
GDB is a debugger which can allow us to view the state of the registers,
stack, memory locations etc throughout the execution of a program(I Know
this is the most basic tutorial and introducing GDB may not be the
correct idea right now, but for the sake of running the noexec function
we need its memory address).</p>

<pre><code>#gdb ./rofl
</code></pre>

<p>The above command will run the program in GDB. To find the starting
address of the <code>noexec()</code> function we need to input a simple command which
is <code>disassemble</code> followed by the name of the function as follows:</p>

<pre><code>(gdb) disas noexec**
</code></pre>

<p>this command will output the following-
<p align="center">
<a href="/images/2014-10-27-exploit-writing-series-tutorial-1-buffer-overflow-on-linux-2.png"><img src="/images/thumbnails/2014-10-27-exploit-writing-series-tutorial-1-buffer-overflow-on-linux-2.png" alt="" /></a>
</p>
Don&rsquo;t get scared! for Now, we only need the address of the first
instruction which is <code>0x0804847c</code>.</p>

<p>Next, we simply need to input this address after 54 A characters and this will overwrite the memory from where EIP will load a value resulting in altering the flow of the program according to our needs.</p>

<p>Let&rsquo;s test it out:
Keeping it simple, we will supply 54 A&rsquo;s and the address in Little
endian format which is to reverse the bytes (<strong>For Example</strong>:split the bytes <code>08 04
84 7c</code> to <code>7c 84 04 08</code>).
<p align="center">
<a href="/images/2014-10-27-exploit-writing-series-tutorial-1-buffer-overflow-on-linux-3.png"><img src="/images/thumbnails/2014-10-27-exploit-writing-series-tutorial-1-buffer-overflow-on-linux-3.png" alt="" /></a>
</p>
We can see that after outputting the input, noexec function runs thus
outputting <code>This Function Does Not Execute</code>.</p>

<p>This tutorial is purely for the newbies in exploit writing. If You liked
this tutorial, comment your feedback and suggestions.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="/tags/learn-exploit-development">learn exploit development</a></span><span class="tag"><a href="/tags/linux-exploit-writing">linux exploit writing</a></span><span class="tag"><a href="/tags/exploit-writing-part-1">exploit writing part 1</a></span><span class="tag"><a href="/tags/exploit-writing">exploit writing</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>957 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2014-10-27 21:05 &#43;0530</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h"></span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="/posts/2014/11/android-keypad-tones-a-perfect-bluebox/">
                                <span class="button__icon">←</span>
                                <span class="button__text">Android Keypad Tones, A Perfect BlueBox!</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="/posts/2014/09/fixing-sickfuzz-for-kali-linux/">
                                <span class="button__text">Fixing SickFuzz for Kali Linux</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="/">Apex Predator</a></span>
            
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span> <a href="/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.4c3fb12a087ceed4a52cb5d57068a9795c7069617a01ca70f788052ad66e1791779e6c72686e1dc0ca13dc03b0203204b6566bb0dd1ee80de2b7ff4d8fe53db2.js" integrity="sha512-TD&#43;xKgh87tSlLLXVcGipeVxwaWF6Acpw94gFKtZuF5F3nmxyaG4dwMoT3AOwIDIEtlZrsN0e6A3it/9Nj&#43;U9sg=="></script>



    </body>
</html>
